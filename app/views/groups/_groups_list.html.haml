%ul.container_16
  %li.grid_16.lined.table_header
    %span.grid_1.alpha= "&nbsp;".html_safe
    %span.grid_3= link_to 'Name', '#', :id => 'group_name_sort'
    %span.grid_4.descrip Description
    %span.grid_3= link_to 'Issue Area of Focus', '#', :id => 'group_issue_sort'
    %span.grid_2= link_to 'Members', '#', :id => 'group_members_sort'
    %span.grid_1.omega
    
%ul.container_16
  - groups.each do |g|
    %li.grid_16.lined
      %span.grid_1.alpha
        .thumb.smaller= group_image(g)
      %span.grid_3= link_to "<strong>#{g.name}</strong>".html_safe, g
      %span.grid_4.descrip= g.description
      %span.grid_3= g.pvs_category.nil? ? "None" : g.pvs_category.name
      %span.grid_2= g.active_members.size + 1
      - if logged_in?
        - if g.is_member?(current_user)
          %span.grid_1.omega= link_to 'Leave', group_group_member_path(g, g.group_members.find_by_user_id(current_user.id)), :method => 'delete', :class => 'button yellow small floatright'
          
        - else
          - if g.can_join?(current_user)
            %span.grid_1.omega= link_to 'Join', group_group_members_path(g, :status => 'MEMBER'), :method => 'post', :class => 'button blue small floatright'
      - else
        - if g.join_type == 'ANYONE'
          %span.grid_1.omega= link_to 'Join', group_group_members_path(g, :status => 'MEMBER'), :method => 'post', :class => 'button blue small floatright'
